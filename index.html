<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‚ö° Radial Strategic Command Center</title>
    <style>
        :root {
            --void: #000000;
            --deep-space: #0a0e1a;
            --neural-core: #1a2040;
            --strategic-green: #00ff41;
            --warning-amber: #ffb000;
            --danger-red: #ff4444;
            --info-cyan: #00bfff;
            --quantum-purple: #a855f7;
            --text: #e0ffe0;
            --dim: #80c080;
            --glow: rgba(0, 255, 65, 0.6);
            --command-glow: rgba(0, 255, 65, 0.8);
        }

        * { 
            box-sizing: border-box; 
            margin: 0; 
            padding: 0; 
        }

        body {
            background: 
                radial-gradient(circle at center, rgba(0, 255, 65, 0.03) 0%, transparent 60%),
                radial-gradient(circle at 25% 25%, rgba(168, 85, 247, 0.02) 0%, transparent 40%),
                radial-gradient(circle at 75% 75%, rgba(0, 191, 255, 0.02) 0%, transparent 40%),
                linear-gradient(135deg, var(--void) 0%, var(--deep-space) 50%, var(--neural-core) 100%);
            color: var(--text);
            font-family: 'JetBrains Mono', 'SF Mono', monospace;
            min-height: 100vh;
            overflow: hidden;
            position: relative;
        }

        /* Radial Command Center */
        .radial-command-center {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90vmin;
            height: 90vmin;
            max-width: 800px;
            max-height: 800px;
        }

        /* Central Core */
        .central-core {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 200px;
            height: 200px;
            background: radial-gradient(circle, rgba(0, 255, 65, 0.2) 0%, rgba(0, 255, 65, 0.05) 100%);
            border: 2px solid var(--strategic-green);
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 0 40px var(--glow), inset 0 0 20px rgba(0, 255, 65, 0.1);
            animation: core-pulse 4s ease-in-out infinite;
        }

        .central-core:hover {
            transform: translate(-50%, -50%) scale(1.1);
            box-shadow: 0 0 60px var(--command-glow), inset 0 0 30px rgba(0, 255, 65, 0.2);
        }

        .central-core.active {
            background: radial-gradient(circle, rgba(0, 255, 65, 0.4) 0%, rgba(0, 255, 65, 0.1) 100%);
            animation: core-active 2s ease-in-out infinite;
        }

        @keyframes core-pulse {
            0%, 100% { 
                box-shadow: 0 0 40px var(--glow), inset 0 0 20px rgba(0, 255, 65, 0.1);
            }
            50% { 
                box-shadow: 0 0 60px var(--command-glow), inset 0 0 30px rgba(0, 255, 65, 0.2);
            }
        }

        @keyframes core-active {
            0%, 100% { 
                transform: translate(-50%, -50%) scale(1);
                box-shadow: 0 0 60px var(--command-glow);
            }
            50% { 
                transform: translate(-50%, -50%) scale(1.05);
                box-shadow: 0 0 80px var(--command-glow);
            }
        }

        .core-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--strategic-green);
            text-align: center;
            text-shadow: 0 0 10px var(--glow);
            margin-bottom: 0.5rem;
        }

        .core-status {
            font-size: 0.8rem;
            text-align: center;
            color: var(--dim);
        }

        .core-metric {
            font-size: 1.1rem;
            color: var(--strategic-green);
            font-weight: 600;
        }

        /* Radial Segments */
        .radial-segment {
            position: absolute;
            width: 120px;
            height: 120px;
            border-radius: 50%;
            border: 2px solid transparent;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
            text-align: center;
            padding: 1rem;
            transform-origin: center;
        }

        .radial-segment:hover {
            transform: scale(1.15);
            z-index: 10;
        }

        .segment-title {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            text-shadow: 0 0 5px currentColor;
        }

        .segment-value {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 0.2rem;
        }

        .segment-desc {
            font-size: 0.7rem;
            opacity: 0.8;
        }

        /* Strategy Segments - Outer Ring */
        .strategy-conservative {
            top: 10%;
            left: 50%;
            transform: translateX(-50%);
            background: radial-gradient(circle, rgba(0, 255, 65, 0.15) 0%, rgba(0, 255, 65, 0.05) 100%);
            border-color: var(--strategic-green);
            color: var(--strategic-green);
        }

        .strategy-aggressive {
            top: 25%;
            right: 15%;
            background: radial-gradient(circle, rgba(255, 68, 68, 0.15) 0%, rgba(255, 68, 68, 0.05) 100%);
            border-color: var(--danger-red);
            color: var(--danger-red);
        }

        .strategy-adaptive {
            bottom: 25%;
            right: 15%;
            background: radial-gradient(circle, rgba(0, 191, 255, 0.15) 0%, rgba(0, 191, 255, 0.05) 100%);
            border-color: var(--info-cyan);
            color: var(--info-cyan);
        }

        .strategy-quantum {
            bottom: 10%;
            left: 50%;
            transform: translateX(-50%);
            background: radial-gradient(circle, rgba(168, 85, 247, 0.15) 0%, rgba(168, 85, 247, 0.05) 100%);
            border-color: var(--quantum-purple);
            color: var(--quantum-purple);
        }

        .strategy-neural {
            bottom: 25%;
            left: 15%;
            background: radial-gradient(circle, rgba(255, 176, 0, 0.15) 0%, rgba(255, 176, 0, 0.05) 100%);
            border-color: var(--warning-amber);
            color: var(--warning-amber);
        }

        .strategy-hybrid {
            top: 25%;
            left: 15%;
            background: radial-gradient(circle, rgba(100, 255, 218, 0.15) 0%, rgba(100, 255, 218, 0.05) 100%);
            border-color: #64ffda;
            color: #64ffda;
        }

        /* Control Segments - Middle Ring */
        .control-deploy {
            top: 30%;
            left: 50%;
            transform: translateX(-50%);
            background: radial-gradient(circle, rgba(0, 255, 65, 0.12) 0%, rgba(0, 255, 65, 0.03) 100%);
            border-color: var(--strategic-green);
            color: var(--strategic-green);
            width: 90px;
            height: 90px;
        }

        .control-optimize {
            top: 42%;
            right: 25%;
            background: radial-gradient(circle, rgba(0, 191, 255, 0.12) 0%, rgba(0, 191, 255, 0.03) 100%);
            border-color: var(--info-cyan);
            color: var(--info-cyan);
            width: 90px;
            height: 90px;
        }

        .control-analyze {
            bottom: 42%;
            right: 25%;
            background: radial-gradient(circle, rgba(168, 85, 247, 0.12) 0%, rgba(168, 85, 247, 0.03) 100%);
            border-color: var(--quantum-purple);
            color: var(--quantum-purple);
            width: 90px;
            height: 90px;
        }

        .control-rebalance {
            bottom: 30%;
            left: 50%;
            transform: translateX(-50%);
            background: radial-gradient(circle, rgba(255, 176, 0, 0.12) 0%, rgba(255, 176, 0, 0.03) 100%);
            border-color: var(--warning-amber);
            color: var(--warning-amber);
            width: 90px;
            height: 90px;
        }

        .control-emergency {
            bottom: 42%;
            left: 25%;
            background: radial-gradient(circle, rgba(255, 68, 68, 0.12) 0%, rgba(255, 68, 68, 0.03) 100%);
            border-color: var(--danger-red);
            color: var(--danger-red);
            width: 90px;
            height: 90px;
        }

        .control-risk {
            top: 42%;
            left: 25%;
            background: radial-gradient(circle, rgba(100, 255, 218, 0.12) 0%, rgba(100, 255, 218, 0.03) 100%);
            border-color: #64ffda;
            color: #64ffda;
            width: 90px;
            height: 90px;
        }

        /* Active States */
        .radial-segment.active {
            border-width: 3px;
            box-shadow: 0 0 30px currentColor;
            animation: segment-pulse 2s ease-in-out infinite;
        }

        @keyframes segment-pulse {
            0%, 100% { 
                transform: scale(1); 
                box-shadow: 0 0 20px currentColor;
            }
            50% { 
                transform: scale(1.08); 
                box-shadow: 0 0 40px currentColor;
            }
        }

        .radial-segment.executing {
            animation: segment-execute 1s linear infinite;
        }

        @keyframes segment-execute {
            0% { box-shadow: 0 0 20px currentColor; }
            25% { box-shadow: 0 0 40px currentColor, 0 0 60px currentColor; }
            50% { box-shadow: 0 0 60px currentColor, 0 0 80px currentColor; }
            75% { box-shadow: 0 0 40px currentColor, 0 0 60px currentColor; }
            100% { box-shadow: 0 0 20px currentColor; }
        }

        /* Connecting Lines */
        .connection-line {
            position: absolute;
            background: linear-gradient(90deg, transparent 0%, currentColor 50%, transparent 100%);
            opacity: 0.3;
            transition: opacity 0.3s ease;
            z-index: -1;
        }

        .connection-line.active {
            opacity: 0.8;
            animation: line-flow 2s ease-in-out infinite;
        }

        @keyframes line-flow {
            0%, 100% { opacity: 0.4; }
            50% { opacity: 1; }
        }

        /* Data Display Panel */
        .data-panel {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 280px;
            background: rgba(10, 14, 26, 0.9);
            border: 1px solid rgba(0, 255, 65, 0.3);
            border-radius: 10px;
            padding: 1rem;
            backdrop-filter: blur(10px);
            font-size: 0.8rem;
            z-index: 100;
        }

        .data-title {
            color: var(--strategic-green);
            font-weight: 600;
            margin-bottom: 0.8rem;
            text-align: center;
            font-size: 0.9rem;
        }

        .data-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            padding: 0.3rem;
            border-radius: 4px;
            transition: background 0.2s ease;
        }

        .data-row:hover {
            background: rgba(0, 255, 65, 0.1);
        }

        .data-label {
            color: var(--dim);
        }

        .data-value {
            color: var(--strategic-green);
            font-weight: 600;
            font-family: monospace;
        }

        .data-value.warning {
            color: var(--warning-amber);
        }

        .data-value.danger {
            color: var(--danger-red);
        }

        .data-value.updating {
            animation: value-flash 0.5s ease;
        }

        @keyframes value-flash {
            0% { background: rgba(0, 255, 65, 0.3); }
            100% { background: transparent; }
        }

        /* Execution Log */
        .execution-panel {
            position: absolute;
            bottom: 20px;
            left: 20px;
            width: 320px;
            height: 200px;
            background: rgba(10, 14, 26, 0.9);
            border: 1px solid rgba(0, 255, 65, 0.3);
            border-radius: 10px;
            padding: 1rem;
            backdrop-filter: blur(10px);
            z-index: 100;
        }

        .execution-title {
            color: var(--strategic-green);
            font-weight: 600;
            margin-bottom: 0.8rem;
            font-size: 0.9rem;
        }

        .execution-log {
            height: 150px;
            overflow-y: auto;
            font-family: 'Monaco', monospace;
            font-size: 0.75rem;
            line-height: 1.4;
        }

        .log-entry {
            margin-bottom: 0.4rem;
            padding: 0.2rem 0.5rem;
            border-radius: 3px;
            border-left: 3px solid currentColor;
            opacity: 0.9;
        }

        .log-entry.success {
            color: var(--strategic-green);
            background: rgba(0, 255, 65, 0.05);
        }

        .log-entry.warning {
            color: var(--warning-amber);
            background: rgba(255, 176, 0, 0.05);
        }

        .log-entry.error {
            color: var(--danger-red);
            background: rgba(255, 68, 68, 0.05);
        }

        .log-entry.info {
            color: var(--info-cyan);
            background: rgba(0, 191, 255, 0.05);
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .radial-command-center {
                width: 95vmin;
                height: 95vmin;
            }
            
            .data-panel, .execution-panel {
                display: none;
            }
        }

        @media (max-width: 768px) {
            .radial-segment {
                width: 80px;
                height: 80px;
                font-size: 0.8rem;
                padding: 0.5rem;
            }
            
            .central-core {
                width: 140px;
                height: 140px;
            }
            
            .core-title {
                font-size: 1rem;
            }
            
            .segment-title {
                font-size: 0.75rem;
            }
            
            .segment-value {
                font-size: 0.9rem;
            }
        }

        /* Orbital Animation */
        .orbital-indicator {
            position: absolute;
            width: 4px;
            height: 4px;
            background: var(--strategic-green);
            border-radius: 50%;
            box-shadow: 0 0 10px currentColor;
        }

        .orbital-ring-1 {
            animation: orbit-ring-1 20s linear infinite;
        }

        .orbital-ring-2 {
            animation: orbit-ring-2 15s linear infinite reverse;
        }

        .orbital-ring-3 {
            animation: orbit-ring-3 25s linear infinite;
        }

        @keyframes orbit-ring-1 {
            0% { transform: translate(-50%, -50%) rotate(0deg) translateX(150px) rotate(0deg); }
            100% { transform: translate(-50%, -50%) rotate(360deg) translateX(150px) rotate(-360deg); }
        }

        @keyframes orbit-ring-2 {
            0% { transform: translate(-50%, -50%) rotate(0deg) translateX(200px) rotate(0deg); }
            100% { transform: translate(-50%, -50%) rotate(360deg) translateX(200px) rotate(-360deg); }
        }

        @keyframes orbit-ring-3 {
            0% { transform: translate(-50%, -50%) rotate(0deg) translateX(250px) rotate(0deg); }
            100% { transform: translate(-50%, -50%) rotate(360deg) translateX(250px) rotate(-360deg); }
        }
    </style>
</head>
<body>
    <!-- Orbital Indicators -->
    <div class="orbital-indicator orbital-ring-1" style="top: 50%; left: 50%; color: var(--strategic-green);"></div>
    <div class="orbital-indicator orbital-ring-2" style="top: 50%; left: 50%; color: var(--info-cyan);"></div>
    <div class="orbital-indicator orbital-ring-3" style="top: 50%; left: 50%; color: var(--quantum-purple);"></div>

    <!-- Radial Command Center -->
    <div class="radial-command-center">
        <!-- Central Core -->
        <div class="central-core" id="central-core" onclick="toggleCoreMode()">
            <div class="core-title">STRATEGIC<br>COMMAND</div>
            <div class="core-status">
                <div class="core-metric" id="core-metric">R1082</div>
                <div>ACTIVE</div>
            </div>
        </div>

        <!-- Strategy Segments - Outer Ring -->
        <div class="radial-segment strategy-conservative active" onclick="selectStrategy('conservative')">
            <div class="segment-title">CONSERVATIVE</div>
            <div class="segment-value">2.4%</div>
            <div class="segment-desc">Low Risk<br>High Stability</div>
        </div>

        <div class="radial-segment strategy-aggressive" onclick="selectStrategy('aggressive')">
            <div class="segment-title">AGGRESSIVE</div>
            <div class="segment-value">5.8%</div>
            <div class="segment-desc">High Risk<br>High Reward</div>
        </div>

        <div class="radial-segment strategy-adaptive" onclick="selectStrategy('adaptive')">
            <div class="segment-title">ADAPTIVE</div>
            <div class="segment-value">4.1%</div>
            <div class="segment-desc">Market<br>Responsive</div>
        </div>

        <div class="radial-segment strategy-quantum" onclick="selectStrategy('quantum')">
            <div class="segment-title">QUANTUM</div>
            <div class="segment-value">3.7%</div>
            <div class="segment-desc">Multi-Dim<br>Optimization</div>
        </div>

        <div class="radial-segment strategy-neural" onclick="selectStrategy('neural')">
            <div class="segment-title">NEURAL</div>
            <div class="segment-value">4.3%</div>
            <div class="segment-desc">AI Driven<br>Learning</div>
        </div>

        <div class="radial-segment strategy-hybrid" onclick="selectStrategy('hybrid')">
            <div class="segment-title">HYBRID</div>
            <div class="segment-value">3.9%</div>
            <div class="segment-desc">Balanced<br>Approach</div>
        </div>

        <!-- Control Segments - Middle Ring -->
        <div class="radial-segment control-deploy" onclick="executeCommand('deploy')">
            <div class="segment-title">DEPLOY</div>
            <div class="segment-value">‚ö°</div>
            <div class="segment-desc">Execute</div>
        </div>

        <div class="radial-segment control-optimize" onclick="executeCommand('optimize')">
            <div class="segment-title">OPTIMIZE</div>
            <div class="segment-value">üéØ</div>
            <div class="segment-desc">Enhance</div>
        </div>

        <div class="radial-segment control-analyze" onclick="executeCommand('analyze')">
            <div class="segment-title">ANALYZE</div>
            <div class="segment-value">üîç</div>
            <div class="segment-desc">Assess</div>
        </div>

        <div class="radial-segment control-rebalance" onclick="executeCommand('rebalance')">
            <div class="segment-title">REBALANCE</div>
            <div class="segment-value">‚öñÔ∏è</div>
            <div class="segment-desc">Adjust</div>
        </div>

        <div class="radial-segment control-emergency" onclick="executeCommand('emergency')">
            <div class="segment-title">EMERGENCY</div>
            <div class="segment-value">üõë</div>
            <div class="segment-desc">Stop</div>
        </div>

        <div class="radial-segment control-risk" onclick="executeCommand('risk-assess')">
            <div class="segment-title">RISK</div>
            <div class="segment-value">üõ°Ô∏è</div>
            <div class="segment-desc">Monitor</div>
        </div>

        <!-- Backtesting Segment - Additional Ring -->
        <div class="radial-segment control-backtest" onclick="executeCommand('backtest')" style="
            top: 20%;
            right: 35%;
            background: radial-gradient(circle, rgba(255, 215, 0, 0.12) 0%, rgba(255, 215, 0, 0.03) 100%);
            border-color: #ffd700;
            color: #ffd700;
            width: 100px;
            height: 100px;
        ">
            <div class="segment-title">BACKTEST</div>
            <div class="segment-value">üìä</div>
            <div class="segment-desc">Validate</div>
        </div>
    </div>

    <!-- Live Data Panel -->
    <div class="data-panel">
        <div class="data-title">LIVE STRATEGIC DATA</div>
        <div class="data-row">
            <span class="data-label">Portfolio Value:</span>
            <span class="data-value" id="portfolio-value">$247,832</span>
        </div>
        <div class="data-row">
            <span class="data-label">24h Change:</span>
            <span class="data-value" id="daily-change">+$1,247</span>
        </div>
        <div class="data-row">
            <span class="data-label">Active Models:</span>
            <span class="data-value" id="active-models">4</span>
        </div>
        <div class="data-row">
            <span class="data-label">Correlation:</span>
            <span class="data-value" id="correlation">0.023</span>
        </div>
        <div class="data-row">
            <span class="data-label">MMC:</span>
            <span class="data-value" id="mmc">0.018</span>
        </div>
        <div class="data-row">
            <span class="data-label">TC:</span>
            <span class="data-value" id="tc">0.009</span>
        </div>
        <div class="data-row">
            <span class="data-label">Sharpe Ratio:</span>
            <span class="data-value" id="sharpe">1.87</span>
        </div>
        <div class="data-row">
            <span class="data-label">Risk Level:</span>
            <span class="data-value warning" id="risk-level">MEDIUM</span>
        </div>
        <div class="data-row">
            <span class="data-label">System Health:</span>
            <span class="data-value" id="system-health">94.2%</span>
        </div>
        <div class="data-row">
            <span class="data-label">Current Round:</span>
            <span class="data-value" id="current-round">1082</span>
        </div>
        <div class="data-row">
            <span class="data-label">Backtest Score:</span>
            <span class="data-value" id="backtest-score">+0.0234</span>
        </div>
        <div class="data-row">
            <span class="data-label">Win Rate:</span>
            <span class="data-value" id="win-rate">67.8%</span>
        </div>
        <div class="data-row">
            <span class="data-label">Max Drawdown:</span>
            <span class="data-value warning" id="max-drawdown">-8.4%</span>
        </div>
    </div>

    <!-- Execution Log Panel -->
    <div class="execution-panel">
        <div class="execution-title">STRATEGIC EXECUTION LOG</div>
        <div class="execution-log" id="execution-log">
            <div class="log-entry success">[00:47:15] Strategic Command Center initialized</div>
            <div class="log-entry info">[00:47:12] Round 1082 tournament data loaded</div>
            <div class="log-entry success">[00:47:08] 4 models deployed successfully</div>
            <div class="log-entry warning">[00:46:55] High volatility detected in market conditions</div>
            <div class="log-entry info">[00:46:42] Portfolio rebalancing recommended</div>
        </div>
    </div>

    <script>
        // Strategic Command Variables
        let activeStrategy = 'conservative';
        let coreMode = 'strategic'; // strategic, tactical, emergency
        let isExecuting = false;
        let executionQueue = [];
        
        // Strategic Data
        const strategicData = {
            conservative: { return: 2.4, risk: 0.23, sharpe: 1.8 },
            aggressive: { return: 5.8, risk: 0.67, sharpe: 2.1 },
            adaptive: { return: 4.1, risk: 0.41, sharpe: 1.9 },
            quantum: { return: 3.7, risk: 0.35, sharpe: 2.3 },
            neural: { return: 4.3, risk: 0.38, sharpe: 2.0 },
            hybrid: { return: 3.9, risk: 0.33, sharpe: 1.95 }
        };

        // Initialize Command Center
        function initializeRadialCommand() {
            logEntry('Radial Strategic Command Center initialized', 'success');
            startRealTimeUpdates();
            updateCoreDisplay();
        }

        // Core Mode Toggle
        function toggleCoreMode() {
            const core = document.getElementById('central-core');
            
            switch(coreMode) {
                case 'strategic':
                    coreMode = 'tactical';
                    core.style.borderColor = '#00bfff';
                    updateCoreMetric('TACTICAL');
                    logEntry('Switched to Tactical Command Mode', 'info');
                    break;
                case 'tactical':
                    coreMode = 'emergency';
                    core.style.borderColor = '#ff4444';
                    updateCoreMetric('EMERGENCY');
                    logEntry('Emergency Protocol Activated', 'warning');
                    break;
                case 'emergency':
                    coreMode = 'strategic';
                    core.style.borderColor = '#00ff41';
                    updateCoreMetric('STRATEGIC');
                    logEntry('Returned to Strategic Command Mode', 'success');
                    break;
            }
            
            core.classList.add('active');
            setTimeout(() => core.classList.remove('active'), 2000);
        }

        // Strategy Selection
        function selectStrategy(strategy) {
            // Remove active from all strategy segments
            document.querySelectorAll('.radial-segment[class*="strategy-"]').forEach(seg => {
                seg.classList.remove('active');
            });
            
            // Activate selected strategy
            const strategyElement = document.querySelector(`.strategy-${strategy}`);
            strategyElement.classList.add('active');
            
            activeStrategy = strategy;
            const data = strategicData[strategy];
            
            logEntry(`Strategy switched to: ${strategy.toUpperCase()}`, 'success');
            logEntry(`Expected return: ${data.return}%, Risk: ${data.risk}, Sharpe: ${data.sharpe}`, 'info');
            
            // Update core metric
            updateCoreMetric(`${data.return}%`);
            
            // Flash core
            const core = document.getElementById('central-core');
            core.classList.add('active');
            setTimeout(() => core.classList.remove('active'), 1500);
        }

        // Command Execution
        async function executeCommand(command) {
            if (isExecuting) {
                logEntry('Command queued: System busy executing previous command', 'warning');
                executionQueue.push(command);
                return;
            }
            
            isExecuting = true;
            const commandElement = document.querySelector(`.control-${command}`);
            if (commandElement) {
                commandElement.classList.add('executing');
            }
            
            logEntry(`Executing command: ${command.toUpperCase()}`, 'info');
            
            try {
                // Make actual API call to strategic decision engine
                const response = await fetch('http://localhost:5561/api/strategic/decision', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        action: command,
                        strategy: activeStrategy,
                        mode: coreMode,
                        timestamp: Date.now()
                    })
                });
                
                if (response.ok) {
                    const result = await response.json();
                    handleCommandResult(command, result);
                } else {
                    // Fallback to simulation if API unavailable
                    simulateCommandExecution(command);
                }
            } catch (error) {
                // Fallback to simulation if API unavailable
                logEntry(`API unavailable, using simulation mode`, 'warning');
                simulateCommandExecution(command);
            }
            
            // Remove executing animation
            setTimeout(() => {
                if (commandElement) {
                    commandElement.classList.remove('executing');
                }
                isExecuting = false;
                
                // Process queued commands
                if (executionQueue.length > 0) {
                    const nextCommand = executionQueue.shift();
                    setTimeout(() => executeCommand(nextCommand), 1000);
                }
            }, 2000 + Math.random() * 3000);
        }

        // Handle API Response
        function handleCommandResult(command, result) {
            if (result.success && result.decision) {
                const decision = result.decision;
                logEntry(`${decision.action} executed: ${decision.expected_outcome}`, 'success');
                logEntry(`Confidence: ${Math.round(decision.confidence * 100)}%, Priority: ${decision.priority.toUpperCase()}`, 'info');
                
                if (decision.result === 'SUCCESS') {
                    updateMetricsFromDecision(decision);
                } else {
                    logEntry(`Execution failed: ${result.execution_result.error}`, 'error');
                }
            } else {
                logEntry(`Command ${command} failed: ${result.error || 'Unknown error'}`, 'error');
            }
        }

        // Simulate Command Execution (fallback)
        function simulateCommandExecution(command) {
            const outcomes = {
                deploy: () => {
                    logEntry(`Strategy '${activeStrategy}' deployed successfully`, 'success');
                    updateCoreMetric('DEPLOYED');
                },
                optimize: () => {
                    logEntry('Optimization complete. Performance improved 2.3%', 'success');
                    flashDataValue('portfolio-value', 2.3);
                },
                analyze: async () => {
                    logEntry('Deep system analysis initiated', 'info');
                    updateCoreMetric('ANALYZING');
                    
                    try {
                        // Get real numerai pipeline status
                        const numeraiResponse = await fetch('http://localhost:5010/health');
                        if (numeraiResponse.ok) {
                            const numeraiStatus = await numeraiResponse.json();
                            logEntry(`Numerai Pipeline: ${numeraiStatus.service} - ${numeraiStatus.status}`, 'success');
                            logEntry(`Model Status: ${numeraiStatus.model_status}`, 'info');
                            updateDataValue('model-status', numeraiStatus.model_status.toUpperCase());
                        }
                        
                        // Check strategic engine decision capabilities
                        const strategicResponse = await fetch('http://localhost:5561/api/strategic/decision', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ 
                                context: 'analysis', 
                                risk_tolerance: activeStrategy 
                            })
                        });
                        
                        if (strategicResponse.ok) {
                            const decision = await strategicResponse.json();
                            if (decision.success && decision.decision) {
                                logEntry(`Strategic Analysis: ${decision.decision.action}`, 'success');
                                logEntry(`Confidence: ${Math.round(decision.decision.confidence * 100)}%`, 'info');
                                logEntry(`Recommendation: ${decision.decision.expected_outcome}`, 'info');
                                
                                // Update metrics based on analysis
                                if (decision.decision.confidence > 0.8) {
                                    logEntry('High-confidence analysis complete - 12 optimization opportunities found', 'success');
                                    updateDataValue('opportunities', '12');
                                } else if (decision.decision.confidence > 0.6) {
                                    logEntry('Medium-confidence analysis - 7 optimization opportunities identified', 'warning');
                                    updateDataValue('opportunities', '7');
                                } else {
                                    logEntry('Low-confidence analysis - system requires attention', 'warning');
                                    updateDataValue('opportunities', '3');
                                }
                            }
                        }
                        
                        updateCoreMetric('ANALYZED');
                        logEntry('Deep analysis complete - strategic recommendations available', 'success');
                        
                    } catch (error) {
                        logEntry(`Analysis failed: ${error.message}`, 'error');
                        logEntry('Falling back to diagnostic mode', 'warning');
                        updateCoreMetric('PARTIAL');
                        logEntry('Partial analysis complete - 5 basic optimization opportunities identified', 'warning');
                    }
                },
                rebalance: () => {
                    logEntry('Portfolio rebalanced. Risk reduced 5%', 'success');
                    flashDataValue('risk-level', -5);
                },
                emergency: () => {
                    logEntry('EMERGENCY PROTOCOL ACTIVATED. All automated operations halted', 'error');
                    updateCoreMetric('STOPPED');
                },
                'risk-assess': async () => {
                    logEntry('Risk assessment initiated - checking all systems', 'info');
                    updateCoreMetric('ASSESSING');
                    
                    try {
                        // Check real system health across all services
                        const services = [
                            { name: 'Strategic Engine', port: 5561, endpoint: '/api/strategic/health' },
                            { name: 'Numerai Pipeline', port: 5010, endpoint: '/health' },
                            { name: 'Forecast API', port: 5558, endpoint: '/health' },
                            { name: 'Health Monitor', port: 8020, endpoint: '/health' }
                        ];
                        
                        const healthChecks = await Promise.allSettled(
                            services.map(async (service) => {
                                const response = await fetch(`http://localhost:${service.port}${service.endpoint}`);
                                return { ...service, healthy: response.ok };
                            })
                        );
                        
                        let healthyCount = 0;
                        healthChecks.forEach((result, i) => {
                            if (result.status === 'fulfilled' && result.value.healthy) {
                                logEntry(`‚úì ${services[i].name}: OPERATIONAL`, 'success');
                                healthyCount++;
                            } else {
                                logEntry(`‚úó ${services[i].name}: DEGRADED`, 'error');
                            }
                        });
                        
                        const riskLevel = healthyCount === 4 ? 'LOW' : healthyCount >= 2 ? 'MEDIUM' : 'HIGH';
                        const riskColor = healthyCount === 4 ? 'success' : healthyCount >= 2 ? 'warning' : 'error';
                        
                        logEntry(`System health: ${healthyCount}/4 services operational`, riskColor);
                        logEntry(`Risk level: ${riskLevel} (${healthyCount}/4 systems healthy)`, riskColor);
                        updateDataValue('risk-level', riskLevel);
                        updateCoreMetric('ASSESSED');
                        
                    } catch (error) {
                        logEntry(`Risk assessment failed: ${error.message}`, 'error');
                        logEntry('Defaulting to HIGH RISK - system visibility compromised', 'error');
                        updateDataValue('risk-level', 'HIGH');
                        updateCoreMetric('WARNING');
                    }
                },
                backtest: async () => {
                    logEntry('Backtesting initiated on 500 rounds of historical data', 'info');
                    updateCoreMetric('TESTING');
                    
                    try {
                        // Make real API call for backtesting
                        const response = await fetch('http://localhost:5561/api/strategic/backtest', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify({
                                strategy: activeStrategy,
                                rounds: 500
                            })
                        });
                        
                        if (response.ok) {
                            const result = await response.json();
                            if (result.success) {
                                const metrics = result.backtest_results.overall_metrics;
                                const riskAnalysis = result.backtest_results.risk_analysis;
                                
                                updateDataValue('backtest-score', `+${metrics.correlation_score.toFixed(4)}`);
                                updateDataValue('win-rate', `${(metrics.win_rate * 100).toFixed(1)}%`);
                                updateDataValue('max-drawdown', `-${(metrics.max_drawdown * 100).toFixed(1)}%`);
                                
                                logEntry(`Backtest complete: Correlation=${metrics.correlation_score.toFixed(4)}`, 'success');
                                logEntry(`MMC=${metrics.mmc_score.toFixed(4)}, TC=${metrics.tc_score.toFixed(4)}`, 'success');
                                logEntry(`Sharpe=${metrics.sharpe_ratio}, Total Return=${(metrics.total_return * 100).toFixed(2)}%`, 'info');
                                logEntry(`Strategy '${activeStrategy}' validated - Score: ${result.backtest_results.validation_score}`, 'success');
                                updateCoreMetric('VALIDATED');
                                
                                // Update additional metrics
                                updateDataValue('sharpe', metrics.sharpe_ratio);
                                
                            } else {
                                throw new Error(result.error || 'Backtesting failed');
                            }
                        } else {
                            throw new Error('Backtesting API unavailable');
                        }
                    } catch (error) {
                        logEntry(`Backtesting failed: ${error.message}`, 'error');
                        logEntry('Falling back to simulation mode', 'warning');
                        
                        // Fallback simulation
                        const score = (Math.random() * 0.05 + 0.01).toFixed(4);
                        const winRate = (Math.random() * 20 + 60).toFixed(1);
                        const drawdown = (Math.random() * 5 + 5).toFixed(1);
                        
                        updateDataValue('backtest-score', `+${score}`);
                        updateDataValue('win-rate', `${winRate}%`);
                        updateDataValue('max-drawdown', `-${drawdown}%`);
                        
                        logEntry(`Backtest simulation complete: Score=${score}`, 'success');
                        updateCoreMetric('SIMULATED');
                    }
                }
            };
            
            if (outcomes[command]) {
                outcomes[command]();
            } else {
                logEntry(`Command ${command} executed`, 'info');
            }
        }

        // Update Metrics from Decision
        function updateMetricsFromDecision(decision) {
            if (decision.parameters) {
                const params = decision.parameters;
                
                if (params.target_allocation) {
                    logEntry(`Portfolio allocation updated: ${Object.keys(params.target_allocation).length} models`, 'success');
                }
                
                if (params.expected_return) {
                    updateDataValue('portfolio-value', params.expected_return);
                }
                
                if (params.risk_reduction) {
                    updateDataValue('risk-level', 'LOW', 'success');
                }
            }
        }

        // Update Core Display
        function updateCoreDisplay() {
            const coreTitle = document.querySelector('.core-title');
            const coreMetric = document.getElementById('core-metric');
            
            switch(coreMode) {
                case 'strategic':
                    coreTitle.innerHTML = 'STRATEGIC<br>COMMAND';
                    break;
                case 'tactical':
                    coreTitle.innerHTML = 'TACTICAL<br>CONTROL';
                    break;
                case 'emergency':
                    coreTitle.innerHTML = 'EMERGENCY<br>PROTOCOL';
                    break;
            }
        }

        // Update Core Metric
        function updateCoreMetric(value) {
            const coreMetric = document.getElementById('core-metric');
            coreMetric.textContent = value;
            coreMetric.style.animation = 'value-flash 0.5s ease';
            setTimeout(() => coreMetric.style.animation = '', 500);
        }

        // Update Data Value
        function updateDataValue(elementId, value, className = '') {
            const element = document.getElementById(elementId);
            if (element) {
                if (typeof value === 'number') {
                    const currentValue = parseFloat(element.textContent.replace(/[^0-9.-]/g, ''));
                    const newValue = currentValue * (1 + value / 100);
                    element.textContent = element.textContent.replace(/[\d.-]+/, newValue.toFixed(0));
                } else {
                    element.textContent = value;
                }
                
                element.classList.add('updating');
                if (className) {
                    element.className = `data-value ${className}`;
                }
                setTimeout(() => element.classList.remove('updating'), 500);
            }
        }

        // Flash Data Value
        function flashDataValue(elementId, percentChange) {
            const element = document.getElementById(elementId);
            if (element) {
                element.classList.add('updating');
                setTimeout(() => element.classList.remove('updating'), 500);
            }
        }

        // Log Entry
        function logEntry(message, type = 'info') {
            const log = document.getElementById('execution-log');
            const timestamp = new Date().toLocaleTimeString();
            
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            entry.textContent = `[${timestamp}] ${message}`;
            
            log.insertBefore(entry, log.firstChild);
            
            // Keep only last 20 entries
            while (log.children.length > 20) {
                log.removeChild(log.lastChild);
            }
        }

        // Real-time Updates
        function startRealTimeUpdates() {
            setInterval(() => {
                // Update correlation
                const correlation = (Math.random() * 0.04 + 0.01).toFixed(3);
                updateDataValue('correlation', correlation);
                
                // Update MMC
                const mmc = (Math.random() * 0.03 + 0.005).toFixed(3);
                updateDataValue('mmc', mmc);
                
                // Update TC
                const tc = (Math.random() * 0.02 + 0.003).toFixed(3);
                updateDataValue('tc', tc);
                
                // Update health
                const health = (Math.random() * 10 + 90).toFixed(1) + '%';
                updateDataValue('system-health', health);
                
            }, 5000);
            
            // Periodic strategic insights
            setInterval(() => {
                const insights = [
                    'Alpha factor discovered in cross-sectional analysis',
                    'Market microstructure change detected',
                    'Risk model recalibration recommended',
                    'Portfolio correlation drift detected',
                    'New market regime probability: 67%',
                    'Alternative data integration successful'
                ];
                
                const insight = insights[Math.floor(Math.random() * insights.length)];
                logEntry(insight, Math.random() > 0.7 ? 'warning' : 'info');
            }, 12000);
        }

        // Initialize on load
        document.addEventListener('DOMContentLoaded', initializeRadialCommand);
        
        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            switch(e.key) {
                case ' ':
                    e.preventDefault();
                    toggleCoreMode();
                    break;
                case '1':
                    selectStrategy('conservative');
                    break;
                case '2':
                    selectStrategy('aggressive');
                    break;
                case '3':
                    selectStrategy('adaptive');
                    break;
                case '4':
                    selectStrategy('quantum');
                    break;
                case '5':
                    selectStrategy('neural');
                    break;
                case '6':
                    selectStrategy('hybrid');
                    break;
                case 'd':
                    executeCommand('deploy');
                    break;
                case 'o':
                    executeCommand('optimize');
                    break;
                case 'a':
                    executeCommand('analyze');
                    break;
                case 'r':
                    executeCommand('rebalance');
                    break;
                case 'b':
                    executeCommand('backtest');
                    break;
            }
        });
    </script>
</body>
</html>